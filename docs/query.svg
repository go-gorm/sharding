<svg id="mermaid-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="2418.462158203125" style="max-width: 1068.5px;" viewBox="0 0 1068.5 2418.462158203125"><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg .error-icon{fill:#552222;}#mermaid-svg .error-text{fill:#552222;stroke:#552222;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:#333333;stroke:#333333;}#mermaid-svg .marker.cross{stroke:#333333;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg .cluster-label text{fill:#333;}#mermaid-svg .cluster-label span{color:#333;}#mermaid-svg .label text,#mermaid-svg span{fill:#333;color:#333;}#mermaid-svg .node rect,#mermaid-svg .node circle,#mermaid-svg .node ellipse,#mermaid-svg .node polygon,#mermaid-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg .node .label{text-align:center;}#mermaid-svg .node.clickable{cursor:pointer;}#mermaid-svg .arrowheadPath{fill:#333333;}#mermaid-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg .cluster text{fill:#333;}#mermaid-svg .cluster span{color:#333;}#mermaid-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><g class="output"><g class="clusters"><g class="cluster" id="flowchart-database-110" transform="translate(578.2500152587891,2238.0810203552246)" style="opacity: 1;"><rect width="928" height="160.76204681396484" x="-464" y="-80.38102340698242"></rect><g class="label" transform="translate(0, -66.38102722167969)" id="mermaid-svgText"><g transform="translate(-32,-11)"><foreignObject width="64" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Database</div></foreignObject></g></g></g><g class="cluster" id="flowchart-sharding-111" transform="translate(534.2500076293945,1417.849998474121)" style="opacity: 1;"><rect width="1052.500015258789" height="1335.6999969482422" x="-526.2500076293945" y="-667.8499984741211"></rect><g class="label" transform="translate(0, -653.8499755859375)" id="mermaid-svgText"><g transform="translate(-44,-11)"><foreignObject width="88" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">MyConnPool</div></foreignObject></g></g></g><g class="cluster" id="flowchart-subGraph1-112" transform="translate(581.3333435058594,608)" style="opacity: 1;"><rect width="635" height="184" x="-317.5" y="-92"></rect><g class="label" transform="translate(0, -78)" id="mermaid-svgText"><g transform="translate(-72,-11)"><foreignObject width="144" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">database/sql - Conn</div></foreignObject></g></g></g><g class="cluster" id="flowchart-Gorm-113" transform="translate(552.0833435058594,374)" style="opacity: 1;"><rect width="334" height="184" x="-167" y="-92"></rect><g class="label" transform="translate(0, -78)" id="mermaid-svgText"><g transform="translate(-19.5,-11)"><foreignObject width="39" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Gorm</div></foreignObject></g></g></g></g><g class="edgePaths"><g class="edgePath LS-first LE-db" id="L-first-db" style="opacity: 1;"><path class="path" d="M552.0833435058594,160L552.0833435058594,164.16666666666666C552.0833435058594,168.33333333333334,552.0833435058594,176.66666666666666,552.0833435058594,186.83333333333334C552.0833435058594,197,552.0833435058594,209,552.0833435058594,221C552.0833435058594,233,552.0833435058594,245,552.0833435058594,255.16666666666666C552.0833435058594,265.3333333333333,552.0833435058594,273.6666666666667,552.0833435058594,282C552.0833435058594,290.3333333333333,552.0833435058594,298.6666666666667,552.0833435058594,302.8333333333333L552.0833435058594,307" marker-end="url(#arrowhead194)" style="fill:none"></path><defs><marker id="arrowhead194" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-db LE-gorm_query" id="L-db-gorm_query" style="opacity: 1;"><path class="path" d="M552.0833435058594,349L552.0833435058594,353.1666666666667C552.0833435058594,357.3333333333333,552.0833435058594,365.6666666666667,552.0833435058594,374C552.0833435058594,382.3333333333333,552.0833435058594,390.6666666666667,552.0833435058594,394.8333333333333L552.0833435058594,399" marker-end="url(#arrowhead195)" style="fill:none"></path><defs><marker id="arrowhead195" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-gorm_query LE-Conn" id="L-gorm_query-Conn" style="opacity: 1;"><path class="path" d="M552.0833435058594,441L552.0833435058594,445.1666666666667C552.0833435058594,449.3333333333333,552.0833435058594,457.6666666666667,552.0833435058594,466C552.0833435058594,474.3333333333333,552.0833435058594,482.6666666666667,552.0833435058594,491C552.0833435058594,499.3333333333333,552.0833435058594,507.6666666666667,552.0833435058594,516C552.0833435058594,524.3333333333334,552.0833435058594,532.6666666666666,552.0833435058594,536.8333333333334L552.0833435058594,541" marker-end="url(#arrowhead196)" style="fill:none"></path><defs><marker id="arrowhead196" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-Conn LE-ExecContext" id="L-Conn-ExecContext" style="opacity: 1;"><path class="path" d="M518.3333435058594,570.4489795918367L493.3333435058594,576.7074829931972C468.3333435058594,582.9659863945578,418.3333435058594,595.4829931972789,393.4166768391927,605.9914965986394C368.50001017252606,616.5,368.6666768391927,625,368.75001017252606,629.25L368.8333435058594,633.5" marker-end="url(#arrowhead197)" style="fill:none"></path><defs><marker id="arrowhead197" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-Conn LE-QueryContext" id="L-Conn-QueryContext" style="opacity: 1;"><path class="path" d="M556.5344304623811,583L557.4175826362942,587.1666666666666C558.3007348102072,591.3333333333334,560.0670391580333,599.6666666666666,561.0335246652797,608.0833333333334C562.000010172526,616.5,562.1666768391927,625,562.250010172526,629.25L562.3333435058594,633.5" marker-end="url(#arrowhead198)" style="fill:none"></path><defs><marker id="arrowhead198" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-Conn LE-QueryRowContext" id="L-Conn-QueryRowContext" style="opacity: 1;"><path class="path" d="M585.8333435058594,568.969696969697L617.3333435058594,575.4747474747475C648.8333435058594,581.979797979798,711.8333435058594,594.989898989899,743.4166768391927,605.7449494949495C775.000010172526,616.5,775.1666768391927,625,775.250010172526,629.25L775.3333435058594,633.5" marker-end="url(#arrowhead199)" style="fill:none"></path><defs><marker id="arrowhead199" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-QueryContext LE-router" id="L-QueryContext-router" style="opacity: 1;"><path class="path" d="M562.3333435058594,675.5L562.250010172526,679.5833333333334C562.1666768391927,683.6666666666666,562.000010172526,691.8333333333334,561.9166768391927,700.0833333333334C561.8333435058594,708.3333333333334,561.8333435058594,716.6666666666666,561.8333435058594,725C561.8333435058594,733.3333333333334,561.8333435058594,741.6666666666666,561.9166768391927,750.0833333333334C562.000010172526,758.5,562.1666768391927,767,562.250010172526,771.25L562.3333435058594,775.5" marker-end="url(#arrowhead200)" style="fill:none"></path><defs><marker id="arrowhead200" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-router LE-format_sql" id="L-router-format_sql" style="opacity: 1;"><path class="path" d="M562.3333435058594,839.5L562.250010172526,843.5833333333334C562.1666768391927,847.6666666666666,562.000010172526,855.8333333333334,562.000010172526,864.1666666666666C562.000010172526,872.5,562.1666768391927,881,562.250010172526,885.25L562.3333435058594,889.5" marker-end="url(#arrowhead201)" style="fill:none"></path><defs><marker id="arrowhead201" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-format_sql LE-parse" id="L-format_sql-parse" style="opacity: 1;"><path class="path" d="M562.3333435058594,1019.5L562.250010172526,1023.5833333333334C562.1666768391927,1027.6666666666667,562.000010172526,1035.8333333333333,562.000010172526,1044.1666666666667C562.000010172526,1052.5,562.1666768391927,1061,562.250010172526,1065.25L562.3333435058594,1069.5" marker-end="url(#arrowhead202)" style="fill:none"></path><defs><marker id="arrowhead202" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-parse LE-check_table" id="L-parse-check_table" style="opacity: 1;"><path class="path" d="M562.3333435058594,1155.5L562.250010172526,1159.5833333333333C562.1666768391927,1163.6666666666667,562.000010172526,1171.8333333333333,562.000010172526,1180.1666669209799C562.000010172526,1188.5000005086265,562.1666768391927,1197.0000010172528,562.250010172526,1201.250001271566L562.3333435058594,1205.500001525879" marker-end="url(#arrowhead203)" style="fill:none"></path><defs><marker id="arrowhead203" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-check_table LE-process_ast" id="L-check_table-process_ast" style="opacity: 1;"><path class="path" d="M499.4561228267542,1352.322777795017L474.68565960660504,1368.718980987221C449.9151963864559,1385.1151841794253,400.37426994615765,1417.9075905638338,375.6038067260085,1440.3037937560377C350.8333435058594,1462.6999969482422,350.8333435058594,1474.6999969482422,350.8333435058594,1480.6999969482422L350.8333435058594,1486.6999969482422" marker-end="url(#arrowhead204)" style="fill:none"></path><defs><marker id="arrowhead204" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-check_table LE-check_table_1" id="L-check_table-check_table_1" style="opacity: 1;"><path class="path" d="M636.5927451747457,1340.9405998569923L681.1189568554196,1359.233832705534C725.6451685360935,1377.5270655540755,814.6975918974413,1414.113531251159,859.2238035781152,1448.5734307663672C903.7500152587891,1483.0333302815754,903.7500152587891,1515.366663614909,903.7500152587891,1547.6999969482422C903.7500152587891,1580.0333302815754,903.7500152587891,1612.366663614909,903.7500152587891,1639.866663614909C903.7500152587891,1667.366663614909,903.7500152587891,1690.0333302815754,903.7500152587891,1712.6999969482422C903.7500152587891,1735.366663614909,903.7500152587891,1758.0333302815754,903.7500152587891,1782.5333302815754C903.7500152587891,1807.0333302815754,903.7500152587891,1833.366663614909,903.7500152587891,1859.6999969482422C903.7500152587891,1886.0333302815754,903.7500152587891,1912.366663614909,903.8333485921224,1935.2833302815754C903.9166819254557,1958.1999969482422,904.0833485921224,1977.6999969482422,904.1666819254557,1987.4499969482422L904.2500152587891,1997.1999969482422" marker-end="url(#arrowhead205)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead205" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-process_ast LE-not_match_error" id="L-process_ast-not_match_error" style="opacity: 1;"><path class="path" d="M299.5685706958969,1580.7593839471406L283.0432542054023,1591.4161527806575C266.5179377149078,1602.0729216141744,233.46730473391872,1623.3864592812085,217.02532157675753,1640.1265614480587C200.58333841959634,1656.866663614909,200.75000508626303,1669.0333302815754,200.83333841959634,1675.116663614909L200.9166717529297,1681.1999969482422" marker-end="url(#arrowhead206)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead206" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-process_ast LE-match_sharding_key" id="L-process_ast-match_sharding_key" style="opacity: 1;"><path class="path" d="M399.8459112368108,1584.0148452119881L413.4965952404739,1594.1290371680304C427.1472792441369,1604.243229124073,454.448647251463,1624.4716130361576,468.09933125512606,1642.4191383255331C481.75001525878906,1660.366663614909,481.75001525878906,1676.0333302815754,481.75001525878906,1683.866663614909L481.75001525878906,1691.6999969482422" marker-end="url(#arrowhead207)" style="fill:none"></path><defs><marker id="arrowhead207" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-match_sharding_key LE-get_new_table_name" id="L-match_sharding_key-get_new_table_name" style="opacity: 1;"><path class="path" d="M481.75001525878906,1733.6999969482422L481.75001525878906,1741.5333302815754C481.75001525878906,1749.366663614909,481.75001525878906,1765.0333302815754,481.8333485921224,1778.9499969482422C481.91668192545575,1792.866663614909,482.0833485921224,1805.0333302815754,482.16668192545575,1811.116663614909L482.25001525878906,1817.1999969482422" marker-end="url(#arrowhead208)" style="fill:none"></path><defs><marker id="arrowhead208" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-get_new_table_name LE-new_sql" id="L-get_new_table_name-new_sql" style="opacity: 1;"><path class="path" d="M482.25001525878906,1903.1999969482422L482.16668192545575,1909.116663614909C482.0833485921224,1915.0333302815754,481.91668192545575,1926.866663614909,481.91668192545575,1938.866663614909C481.91668192545575,1950.866663614909,482.0833485921224,1963.0333302815754,482.16668192545575,1969.116663614909L482.25001525878906,1975.1999969482422" marker-end="url(#arrowhead209)" style="fill:none"></path><defs><marker id="arrowhead209" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-new_sql LE-orders_4" id="L-new_sql-orders_4" style="opacity: 1;"><path class="path" d="M482.25001525878906,2061.199996948242L482.16668192545575,2065.2833302815757C482.0833485921224,2069.3666636149087,481.91668192545575,2077.5333302815757,481.8333485921224,2087.6166636149087C481.75001525878906,2097.699996948242,481.75001525878906,2109.699996948242,481.75001525878906,2121.699996948242C481.75001525878906,2133.699996948242,481.75001525878906,2145.699996948242,481.75001525878906,2159.139309565226C481.75001525878906,2172.5786221822104,481.75001525878906,2187.4572474161782,481.75001525878906,2194.8965600331626L481.75001525878906,2202.3358726501465" marker-end="url(#arrowhead210)" style="fill:none"></path><defs><marker id="arrowhead210" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-check_table_1 LE-other_tables" id="L-check_table_1-other_tables" style="opacity: 1;"><path class="path" d="M904.2500152587891,2039.1999969482422L904.1666819254557,2046.9499969482422C904.0833485921224,2054.699996948242,903.9166819254557,2070.199996948242,903.8333485921224,2083.949996948242C903.7500152587891,2097.699996948242,903.7500152587891,2109.699996948242,903.7500152587891,2121.699996948242C903.7500152587891,2133.699996948242,903.7500152587891,2145.699996948242,903.7500152587891,2155.8666636149087C903.7500152587891,2166.0333302815757,903.7500152587891,2174.3666636149087,903.7500152587891,2178.5333302815757L903.7500152587891,2182.699996948242" marker-end="url(#arrowhead211)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead211" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-orders_4 LE-result" id="L-orders_4-result" style="opacity: 1;"><path class="path" d="M481.75001525878906,2273.8261680603027L481.75001525878906,2281.2654806772866C481.75001525878906,2288.704793294271,481.75001525878906,2303.583418528239,481.75001525878906,2315.1893978118896C481.75001525878906,2326.7953770955405,481.75001525878906,2335.1287104288735,509.4176648314386,2345.126744616908C537.0853144040882,2355.1247788049423,592.4206135493873,2366.787513847677,620.0882631220369,2372.6188813690446L647.7559126946865,2378.4502488904122" marker-end="url(#arrowhead212)" style="fill:none"></path><defs><marker id="arrowhead212" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-other_tables LE-result" id="L-other_tables-result" style="opacity: 1;"><path class="path" d="M903.7500152587891,2293.462043762207L903.7500152587891,2297.6287104288735C903.7500152587891,2301.7953770955405,903.7500152587891,2310.1287104288735,903.7500152587891,2318.462043762207C903.7500152587891,2326.7953770955405,903.7500152587891,2335.1287104288735,879.4156135493873,2344.9599070100703C855.0812118399857,2354.791103591267,806.4124084211822,2366.1201634203267,782.0780067117804,2371.784693334857L757.7436050023788,2377.4492232493867" marker-end="url(#arrowhead213)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead213" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(552.0833435058594,221)" style="opacity: 1;"><g transform="translate(-43.5,-11)" class="label"><rect rx="0" ry="0" width="87" height="22"></rect><foreignObject width="87" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-first-db" class="edgeLabel L-LS-first' L-LE-db">Gorm Query</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-db-gorm_query" class="edgeLabel L-LS-db' L-LE-gorm_query"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-gorm_query-Conn" class="edgeLabel L-LS-gorm_query' L-LE-Conn"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-Conn-ExecContext" class="edgeLabel L-LS-Conn' L-LE-ExecContext"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-Conn-QueryContext" class="edgeLabel L-LS-Conn' L-LE-QueryContext"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-Conn-QueryRowContext" class="edgeLabel L-LS-Conn' L-LE-QueryRowContext"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-QueryContext-router" class="edgeLabel L-LS-QueryContext' L-LE-router"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-router-format_sql" class="edgeLabel L-LS-router' L-LE-format_sql"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-format_sql-parse" class="edgeLabel L-LS-format_sql' L-LE-parse"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-parse-check_table" class="edgeLabel L-LS-parse' L-LE-check_table"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(350.8333435058594,1450.6999969482422)" style="opacity: 1;"><g transform="translate(-17,-11)" class="label"><rect rx="0" ry="0" width="34" height="22"></rect><foreignObject width="34" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-check_table-process_ast" class="edgeLabel L-LS-check_table' L-LE-process_ast">Exist</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(903.7500152587891,1712.6999969482422)" style="opacity: 1;"><g transform="translate(-32,-11)" class="label"><rect rx="0" ry="0" width="64" height="22"></rect><foreignObject width="64" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-check_table-check_table_1" class="edgeLabel L-LS-check_table' L-LE-check_table_1">Not exist</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(200.4166717529297,1644.6999969482422)" style="opacity: 1;"><g transform="translate(-83.5,-11)" class="label"><rect rx="0" ry="0" width="167" height="22"></rect><foreignObject width="167" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-process_ast-not_match_error" class="edgeLabel L-LS-process_ast' L-LE-not_match_error">Not match ShardingKey</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(481.75001525878906,1644.6999969482422)" style="opacity: 1;"><g transform="translate(-67.5,-11)" class="label"><rect rx="0" ry="0" width="135" height="22"></rect><foreignObject width="135" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-process_ast-match_sharding_key" class="edgeLabel L-LS-process_ast' L-LE-match_sharding_key">Match ShardingKey</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(481.75001525878906,1780.6999969482422)" style="opacity: 1;"><g transform="translate(-56,-11)" class="label"><rect rx="0" ry="0" width="112" height="22"></rect><foreignObject width="112" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-match_sharding_key-get_new_table_name" class="edgeLabel L-LS-match_sharding_key' L-LE-get_new_table_name">Get table name</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(481.75001525878906,1938.6999969482422)" style="opacity: 1;"><g transform="translate(-127.5,-11)" class="label"><rect rx="0" ry="0" width="255" height="22"></rect><foreignObject width="255" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-get_new_table_name-new_sql" class="edgeLabel L-LS-get_new_table_name' L-LE-new_sql">Replace TableName to get new SQL</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(481.75001525878906,2121.699996948242)" style="opacity: 1;"><g transform="translate(-55,-11)" class="label"><rect rx="0" ry="0" width="110" height="22"></rect><foreignObject width="110" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-new_sql-orders_4" class="edgeLabel L-LS-new_sql' L-LE-orders_4">Sharding Query</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(903.7500152587891,2121.699996948242)" style="opacity: 1;"><g transform="translate(-75,-11)" class="label"><rect rx="0" ry="0" width="150" height="22"></rect><foreignObject width="150" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-check_table_1-other_tables" class="edgeLabel L-LS-check_table_1' L-LE-other_tables">None sharding Query</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-orders_4-result" class="edgeLabel L-LS-orders_4' L-LE-result"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-other_tables-result" class="edgeLabel L-LS-other_tables' L-LE-result"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-orders_other-97" label-offset-y="16.4850136239782" transform="translate(270.25001525878906,2238.0810203552246)" style="opacity: 1;"><path d="M 0,16.4850136239782 a 121,16.4850136239782 0,0,0 242 0 a 121,16.4850136239782 0,0,0 -242 0 l 0,58.485013623978205 a 121,16.4850136239782 0,0,0 242 0 l 0,-58.485013623978205" transform="translate(-121,-45.72752043596731)" class="label-container"></path><g class="label" transform="translate(0,0)"><g transform="translate(-111,-11)"><foreignObject width="222" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">orders_0, orders_1 ... orders_3</div></foreignObject></g></g></g><g class="node default" id="flowchart-orders_4-98" label-offset-y="9.83009708737864" transform="translate(481.75001525878906,2238.0810203552246)" style="opacity: 1;"><path d="M 0,9.83009708737864 a 40.5,9.83009708737864 0,0,0 81 0 a 40.5,9.83009708737864 0,0,0 -81 0 l 0,51.83009708737864 a 40.5,9.83009708737864 0,0,0 81 0 l 0,-51.83009708737864" transform="translate(-40.5,-35.745145631067956)" class="label-container"></path><g class="label" transform="translate(0,0)"><g transform="translate(-30.5,-11)"><foreignObject width="61" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">orders_4</div></foreignObject></g></g></g><g class="node default" id="flowchart-orders_last-99" label-offset-y="14.686468646864686" transform="translate(661.2500152587891,2238.0810203552246)" style="opacity: 1;"><path d="M 0,14.686468646864686 a 89,14.686468646864686 0,0,0 178 0 a 89,14.686468646864686 0,0,0 -178 0 l 0,56.68646864686468 a 89,14.686468646864686 0,0,0 178 0 l 0,-56.68646864686468" transform="translate(-89,-43.02970297029702)" class="label-container"></path><g class="label" transform="translate(0,0)"><g transform="translate(-79,-11)"><foreignObject width="158" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">orders_5 ... orders_15</div></foreignObject></g></g></g><g class="node default" id="flowchart-other_tables-100" label-offset-y="15.587349397590362" transform="translate(903.7500152587891,2238.0810203552246)" style="opacity: 1;"><path d="M 0,15.587349397590362 a 103.5,15.587349397590362 0,0,0 207 0 a 103.5,15.587349397590362 0,0,0 -207 0 l 0,79.58734939759036 a 103.5,15.587349397590362 0,0,0 207 0 l 0,-79.58734939759036" transform="translate(-103.5,-55.381024096385545)" class="label-container"></path><g class="label" transform="translate(0,0)"><g transform="translate(-93.5,-22)"><foreignObject width="187" height="44"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Other non-sharding tables<br/>users, stocks, topics ...</div></foreignObject></g></g></g><g class="node default" id="flowchart-check_table-77" transform="translate(561.8333435058594,1309.849998474121)" style="opacity: 1;"><polygon points="104.85000000000001,0 209.70000000000002,-104.85000000000001 104.85000000000001,-209.70000000000002 0,-104.85000000000001" transform="translate(-104.85000000000001,104.85000000000001)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-74.5,-22)"><foreignObject width="149" height="44"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Check sharding rules<br/>by table name</div></foreignObject></g></g></g><g class="node default" id="flowchart-parse-76" transform="translate(561.8333435058594,1112)" style="opacity: 1;"><polygon points="0,0 196,0 196,-86 0,-86 0,0 -8,0 204,0 204,-86 -8,-86 -8,0" transform="translate(-98,43)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-88,-33)"><foreignObject width="176" height="66"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Parser SQL to get AST<br/>
  <br/>
  ast = sqlparser.Parse(sql)</div></foreignObject></g></g></g><g class="node default" id="flowchart-format_sql-75" transform="translate(561.8333435058594,954)" style="opacity: 1;"><polygon points="-65,0 267,0 267,-130 -65,-130 0,-65" transform="translate(-133.5,65)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-123.5,-55)"><foreignObject width="247" height="110"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Format sql, args for get full SQL<br/><br/>
    sql = select * from orders<br/>
    where user_id = 100 and status = 1<br/>
    limit 10 order by id desc</div></foreignObject></g></g></g><g class="node default" id="flowchart-router-74" transform="translate(561.8333435058594,807)" style="opacity: 1;"><polygon points="0,0 136,0 136,-64 0,-64 0,0 -8,0 144,0 144,-64 -8,-64 -8,0" transform="translate(-68,32)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-58,-22)"><foreignObject width="116" height="44"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">router(sql, args)<br/><br/></div></foreignObject></g></g></g><g class="node default" id="flowchart-process_ast-82" transform="translate(350.8333435058594,1547.6999969482422)" style="opacity: 1;"><circle x="-61" y="-21" r="61" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-51,-11)"><foreignObject width="102" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Sharding rules</div></foreignObject></g></g></g><g class="node default" id="flowchart-check_table_1-83" transform="translate(903.7500152587891,2017.6999969482422)" style="opacity: 1;"><polygon points="10.5,0 144.5,0 155,-21 144.5,-42 10.5,-42 0,-21" transform="translate(-77.5,21)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-57,-11)"><foreignObject width="114" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Return Raw SQL</div></foreignObject></g></g></g><g class="node default" id="flowchart-not_match_error-84" transform="translate(200.4166717529297,1712.6999969482422)" style="opacity: 1;"><polygon points="-21.333333333333332,0 276.3333333333333,0 244.33333333333334,-64 10.666666666666666,-64" transform="translate(-127.5,32)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-117.5,-22)"><foreignObject width="235" height="44"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Return Error<br/>SQL query must has sharding key</div></foreignObject></g></g></g><g class="node default" id="flowchart-get_new_table_name-89" transform="translate(481.75001525878906,1859.6999969482422)" style="opacity: 1;"><polygon points="0,0 445,0 445,-86 0,-86 0,0 -8,0 453,0 453,-86 -8,-86 -8,0" transform="translate(-222.5,43)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-212.5,-33)"><foreignObject width="425" height="66"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Use value in WhereValue (100) for get sharding table index<br/>orders + (100 % 16)<br/>Sharding Table = orders_4</div></foreignObject></g></g></g><g class="node default" id="flowchart-new_sql-90" transform="translate(481.75001525878906,2017.6999969482422)" style="opacity: 1;"><polygon points="21.5,0 288.5,0 310,-43 288.5,-86 21.5,-86 0,-43" transform="translate(-155,43)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-123.5,-33)"><foreignObject width="247" height="66"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">select * from orders_4<br/>where user_id = 100 and status = 1<br/>limit 10 order by id desc</div></foreignObject></g></g></g><g class="node default" id="flowchart-match_sharding_key-94" transform="translate(481.75001525878906,1712.6999969482422)" style="opacity: 1;"><rect rx="0" ry="0" x="-82.5" y="-21" width="165" height="42" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-72.5,-11)"><foreignObject width="145" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">match_sharding_key</div></foreignObject></g></g></g><g class="node default" id="flowchart-ExecContext-61" transform="translate(368.3333435058594,654)" style="opacity: 1;"><polygon points="-14,0 104,0 125,-42 7,-42" transform="translate(-55.5,21)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-45.5,-11)"><foreignObject width="91" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">ExecContext</div></foreignObject></g></g></g><g class="node default" id="flowchart-QueryContext-62" transform="translate(561.8333435058594,654)" style="opacity: 1;"><polygon points="-14,0 113,0 134,-42 7,-42" transform="translate(-60,21)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-50,-11)"><foreignObject width="100" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">QueryContext</div></foreignObject></g></g></g><g class="node default" id="flowchart-QueryRowContext-63" transform="translate(774.8333435058594,654)" style="opacity: 1;"><polygon points="-14,0 143,0 164,-42 7,-42" transform="translate(-75,21)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-65,-11)"><foreignObject width="130" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">QueryRowContext</div></foreignObject></g></g></g><g class="node default" id="flowchart-Conn-65" transform="translate(552.0833435058594,562)" style="opacity: 1;"><rect rx="21" ry="21" x="-33.75" y="-21" width="67.5" height="42" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-18.5,-11)"><foreignObject width="37" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conn</div></foreignObject></g></g></g><g class="node default" id="flowchart-gorm_query-59" transform="translate(552.0833435058594,420)" style="opacity: 1;"><rect rx="0" ry="0" x="-132" y="-21" width="264" height="42" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-122,-11)"><foreignObject width="244" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">connPool.QueryContext(sql, args)<br/></div></foreignObject></g></g></g><g class="node default" id="flowchart-db-57" transform="translate(552.0833435058594,328)" style="opacity: 1;"><rect rx="0" ry="0" x="-41.5" y="-21" width="83" height="42" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-31.5,-11)"><foreignObject width="63" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Gorm DB</div></foreignObject></g></g></g><g class="node default" id="flowchart-first-55" transform="translate(552.0833435058594,84)" style="opacity: 1;"><rect rx="5" ry="5" x="-123.5" y="-76" width="247" height="152" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-113.5,-66)"><foreignObject width="227" height="132"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">SQL Query<br/><br/>
select * from orders<br/>
where user_id = ? and status = ?<br/>
limit 10 order by id desc<br/>
args = [100, 1]</div></foreignObject></g></g></g><g class="node default" id="flowchart-result-106" transform="translate(702.5000152587891,2389.462043762207)" style="opacity: 1;"><polygon points="-14,0 129,0 108,-42 7,-42" transform="translate(-57.5,21)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-47.5,-11)"><foreignObject width="95" height="22"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Query results</div></foreignObject></g></g></g></g></g></g></svg>